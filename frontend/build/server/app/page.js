(()=>{var e={};e.id=979,e.ids=[979],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},1017:e=>{"use strict";e.exports=require("path")},7310:e=>{"use strict";e.exports=require("url")},2584:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>i.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>d,routeModule:()=>h,tree:()=>l}),r(1838),r(8295),r(5866);var a=r(3191),s=r(8716),n=r(7922),i=r.n(n),c=r(5231),o={};for(let e in c)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>c[e]);r.d(t,o);let l=["",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,1838)),"/home/greg/Documents/WebTech/frontend/src/app/page.js"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,3881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,8295)),"/home/greg/Documents/WebTech/frontend/src/app/layout.js"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,5866,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,3881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],d=["/home/greg/Documents/WebTech/frontend/src/app/page.js"],u="/page",p={require:r,loadChunk:()=>Promise.resolve()},h=new a.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/page",pathname:"/",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},8568:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,2994,23)),Promise.resolve().then(r.t.bind(r,6114,23)),Promise.resolve().then(r.t.bind(r,9727,23)),Promise.resolve().then(r.t.bind(r,9671,23)),Promise.resolve().then(r.t.bind(r,1868,23)),Promise.resolve().then(r.t.bind(r,4759,23))},9076:()=>{},20:(e,t,r)=>{Promise.resolve().then(r.bind(r,628))},238:(e,t,r)=>{"use strict";r.d(t,{Z:()=>i});var a=r(326),s=r(5419),n=r.n(s);function i(e){let t=new Date(e.created).toLocaleString("en-GB",{year:"2-digit",month:"2-digit",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1});return(0,a.jsxs)("div",{className:n().cardItem,onClick:()=>e.clickHandler(e),children:[(0,a.jsxs)("p",{children:["Title: ",e.title]}),(0,a.jsxs)("p",{children:["Description: ",e.desc]}),(0,a.jsxs)("p",{children:["Price: ",e.price,"€"]}),(0,a.jsxs)("p",{children:["Owner: ",e.owner]}),(0,a.jsxs)("p",{children:["Status: ",e.status]}),(0,a.jsxs)("p",{children:["Created: ",t]})]})}},628:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>p});var a=r(326),s=r(5419),n=r.n(s),i=r(434),c=r(7577);function o(){let[e,t]=(0,c.useState)("POPULATE DB"),r=async()=>{let e=await fetch("http://127.0.0.1:8000/populate/",{});t((await e.json()).message)};return a.jsx(a.Fragment,{children:a.jsx("button",{className:n().populatedb,onClick:()=>r(),children:e})})}var l=r(4745),d=r(238);function u(){let[e,t]=(0,c.useState)([]),[r,s]=(0,c.useState)([]),[i,o]=(0,c.useState)([]),[u,p]=(0,c.useState)(""),[h,m]=(0,c.useState)(""),[g,x]=(0,c.useState)(""),f=async(e=g)=>{try{let r=e?`${l.S}/item/?search=${e}`:`${l.S}/item/`,s=await fetch(r),n=await s.json(),i=n.map((e,t)=>a.jsx(d.Z,{title:e.title,desc:e.desc,price:e.price,owner:e.owner,status:e.status,created:e.created,clickHandler:()=>_(e)},t));return t(i),n}catch(e){m("Error fetching data:"+e.message)}},j=async(e,t={})=>await fetch(`${l.S}/me`,{headers:{Authorization:"Bearer null"},...t}),_=async e=>{m("");let t=await j(),a=(await t.text()).replace(/"/g,"");if(401===t.status){m("Not logged in");return}if(e.owner===a){m("Cannot add own items");return}if(-1!=r.findIndex(t=>t.created===e.created)&&-1!==r.findIndex(t=>t.title===e.title)){m("You cannot add the same item again");return}s(t=>[...t,e])},b=async e=>{try{let t=await j(),r=(await t.text()).replace(/"/g,"");try{let t=await fetch("/api/purchase/",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer null"},body:JSON.stringify({price:e.price,title:e.title,desc:e.desc,owner:r,status:"PURCHASED"})});await t.json(),f()}catch(e){return e}let a=await fetch(`/api/buy-item/${e.id}/`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer null"},body:JSON.stringify({price:e.price,title:e.title,desc:e.desc,owner:e.owner,status:"SOLD"})}),s=await a.json();return f(),s}catch(e){return e}},y=async()=>{if(401===(await j()).status){m("Not logged in");return}if(0==r.length){m("Cart is empty");return}let e=await f(),t=[],a=[];e.forEach(e=>{r.forEach(r=>{e.id==r.id&&e.price!==r.price&&t.push(e)})}),r.forEach(t=>{let r=!1;e.forEach(e=>{t.id===e.id&&(r=!0)}),r||a.push(t)});let n="Error: ",i="Error: ";if(0!==t.length){t.forEach(e=>{n+="Price has changed for: "+e.title+",  "}),m(n+="Remove changed item(s) and try again!");return}if(0!==a.length){a.forEach(e=>{i+=e.title+" has already been bought,  "}),m(i+="Remove bought item(s) and try again!");return}r.forEach(e=>{b(e)}),s([]),p(""),m("Successfully bought items")};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("form",{className:n().form,onSubmit:e=>{e.preventDefault(),x(Object.fromEntries(new FormData(e.target).entries()).search.toString()),f(g)},children:[(0,a.jsxs)("label",{children:["Search:",a.jsx("input",{name:"search"})]}),a.jsx("button",{type:"submit",children:"Search"})]}),(0,a.jsxs)("div",{className:n().error,children:["  ",h," "]}),(0,a.jsxs)("div",{className:n().cardList,children:[" ",e," "]}),(0,a.jsxs)("div",{className:n().error,children:["  ",h," "]}),(0,a.jsxs)("div",{className:n().cart,children:[a.jsx("h1",{children:"CART"}),(0,a.jsxs)("p",{children:["Total items: ",r.length]}),(0,a.jsxs)("p",{children:["Total price: ",u,"€"]}),a.jsx("button",{onClick:y,children:"Pay"})]}),i]})}function p(){return(0,a.jsxs)("main",{className:n().main,children:[(0,a.jsxs)("nav",{className:n().navbar,children:[a.jsx("h1",{children:"WEB TECH."}),(0,a.jsxs)("ul",{children:[a.jsx("li",{children:a.jsx(i.default,{href:"./myitems",children:"MY ITEMS"})}),a.jsx("li",{children:a.jsx(i.default,{href:"./login/",children:"LOG IN"})}),a.jsx("li",{children:a.jsx(i.default,{href:"./signup",children:"SIGN UP"})}),a.jsx("li",{children:a.jsx(o,{})})]})]}),a.jsx(u,{})]})}},4745:(e,t,r)=>{"use strict";r.d(t,{S:()=>a});let a="/api"},5419:e=>{e.exports={main:"page_main__GlU4n",Label:"page_Label__shcnZ",navbar:"page_navbar__chktt",populatedb:"page_populatedb__Bqr3l",form:"page_form__Ou5d6",cardList:"page_cardList___XOFY",error:"page_error__Jil8M",cart:"page_cart__1D7QG",back:"page_back__mmxhE",cartItem:"page_cartItem__7B9lv",cardItem:"page_cardItem__57QEU"}},8295:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>c,metadata:()=>i});var a=r(9510),s=r(1402),n=r.n(s);r(5023);let i={title:"WEB TECHNOLOGIES 24",description:"Generated by create next app"};function c({children:e}){return a.jsx("html",{lang:"en",children:a.jsx("body",{className:n().className,children:e})})}},1838:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>i,__esModule:()=>n,default:()=>c});var a=r(8570);let s=(0,a.createProxy)(String.raw`/home/greg/Documents/WebTech/frontend/src/app/page.js`),{__esModule:n,$$typeof:i}=s;s.default;let c=(0,a.createProxy)(String.raw`/home/greg/Documents/WebTech/frontend/src/app/page.js#default`)},3881:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});var a=r(6621);let s=e=>[{type:"image/x-icon",sizes:"16x16",url:(0,a.fillMetadataSegment)(".",e.params,"favicon.ico")+""}]},5023:()=>{}};var t=require("../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[948,54,131],()=>r(2584));module.exports=a})();