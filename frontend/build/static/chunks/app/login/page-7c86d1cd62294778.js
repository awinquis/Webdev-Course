(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[626],{3592:function(e,t,a){Promise.resolve().then(a.bind(a,7015))},7015:function(e,t,a){"use strict";a.r(t);var o=a(7437),r=a(9671),n=a.n(r),s=a(2265),c=a(5482),l=a(7138);let i="access_token",u="refresh_token",d=async()=>{let e=localStorage.getItem(u),t=await fetch("".concat(c.S,"/token/refresh/"),{method:"POST",body:JSON.stringify({refresh:e}),headers:{"Content-type":"application/json"}}),a=await t.json();localStorage.setItem(i,a.access)},g=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=localStorage.getItem(i),a=await fetch("".concat(c.S,"/me/"),{headers:{Authorization:"Bearer ".concat(t)},...e});return 401===a.status&&localStorage.getItem(u)?(await d(),(await fetch("".concat(c.S,"/me/"),{headers:{Authorization:"Bearer ".concat(t)},...e})).text):401==a.status?a.status:a.text()},h=async()=>{try{if(!(await fetch("".concat(c.S,"/logout"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem(i))}})).ok)throw Error("Logout failed");localStorage.removeItem(i),localStorage.removeItem(u)}catch(e){console.error("Error during logout:",e)}};t.default=()=>{let[e,t]=(0,s.useState)(""),[a,r]=(0,s.useState)(""),[d,m]=(0,s.useState)(""),_=async e=>{let{username:t,password:a}=e,o=await fetch("".concat(c.S,"/token/"),{headers:{"Content-type":"application/json"},method:"POST",body:JSON.stringify({username:t,password:a})}),r=await o.json();localStorage.setItem(i,r.access),localStorage.setItem(u,r.refresh)};return(0,o.jsxs)("div",{className:n().main,children:[(0,o.jsx)("h1",{children:"Login Page"}),(0,o.jsx)("p",{children:d}),(0,o.jsxs)("form",{className:n().form,onSubmit:async e=>{e.preventDefault();let t=Object.fromEntries(new FormData(e.target).entries());await _(t);let a=await g();401==a?m("Could not log in"):m("Logged in as: "+a.toString())},children:[(0,o.jsxs)("label",{children:["Username:",(0,o.jsx)("input",{type:"text",name:"username",value:e,required:!0,onChange:e=>{t(e.target.value)}})]}),(0,o.jsxs)("label",{children:["password:",(0,o.jsx)("input",{type:"password",name:"password",value:a,required:!0,onChange:e=>{r(e.target.value)}})]}),(0,o.jsx)("button",{type:"submit",children:"log in"})]}),(0,o.jsx)(l.default,{className:n().back,href:"/account",children:"Reset password"}),(0,o.jsxs)("div",{className:n().form,children:[(0,o.jsx)("h2",{children:"Log out"}),(0,o.jsx)("button",{type:"button",onClick:async()=>{await h(),401==await g()?m("Logged out"):m("Error: Could not log out")},children:"Log out"}),(0,o.jsx)("br",{})]}),(0,o.jsx)(l.default,{className:n().back,href:"/",children:"Back"})]})}},5482:function(e,t,a){"use strict";a.d(t,{S:function(){return o}});let o="/api"},9671:function(e){e.exports={main:"page_main__GlU4n",Label:"page_Label__shcnZ",navbar:"page_navbar__chktt",populatedb:"page_populatedb__Bqr3l",form:"page_form__Ou5d6",cardList:"page_cardList___XOFY",error:"page_error__Jil8M",cart:"page_cart__1D7QG",back:"page_back__mmxhE",cartItem:"page_cartItem__7B9lv",cardItem:"page_cardItem__57QEU"}}},function(e){e.O(0,[967,138,971,23,744],function(){return e(e.s=3592)}),_N_E=e.O()}]);